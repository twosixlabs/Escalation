<!--# Copyright [2020] [Two Six Labs, LLC]-->
<!--# Licensed under the Apache License, Version 2.0-->

{% extends 'base.html' %}
{% block header %}

    <link rel="stylesheet" href="/static/chart.css">

{% endblock %}

{% block content %}
{% include 'navbar.html' %}

<div class="jumbotron">
    <p class="lead">{% autoescape off %}{{ brief_desc }}{% endautoescape %}</p>
    <hr class="my-4">
    <p class="lead">
        {% for dashboard_page in dashboard_pages %}
        <a class="btn btn-primary" href={{ url_for('.graphic_page', page_name=dashboard_page['link']) }} role="button">{{
        dashboard_page['webpage_label'] }}</a>
        {% endfor %}
    </p>
</div>

<div class="container-fluid pl-5 pr-5">
    {% for plot in plots %}
    {% set plot_id = plot['plot_id'] %}
    <form method="post" id={{
    "form_" ~ plot_id  }}>
    <input type="hidden" name="graphic_name" value={{ plot_id }}>
    <input type="hidden" name="process" value="true">
    </form>
    <div class="row" id={{
    plot_id }}>
    <div class="col-10">
            <h1> {{ plot['title'] }} </h1>
            <p>{% autoescape off %}{{ plot['brief_desc'] }}{% endautoescape %}</p>
    </div>
    <div class="col-2">
    </div>
    </div>
    <div class="row">
        <div class="col-10">
            {% set plot_id_str = "plot_{}".format(plot_id)  %}
            <div class="chart" id="{{ plot_id_str }}">
                <script>
                    var graph = {{plot['plot_info'] | safe}};
                    var height = {{ plot['visualization_options']['height'] }}
                    var chart_div = $("{{ "#"~plot_id_str }}")
                    var width = chart_div.width()
                    chart_div.height(height)
                    {% include plot['graph_html_file']%}
                </script>
            </div>
        </div>
        <div class="col-2 text-center">
            {% if plot['select_info'] %}
                {% for selector in plot['select_info'] %}
                    {% set selector_index = loop.index0 %}
                    {% include selector['select_html_file'] ignore missing %}
                {% endfor %}
                 <button type="button" class="btn btn-primary btn-block m-2" onclick=post_to_server('{{ plot_id }}')>Update
                </button>
                <button type="button" class="btn btn-secondary btn-block m-2" onclick=reset_form('{{ plot_id }}')>Reset
                </button>
            {% endif %}
        </div>
    </div>

    {% endfor %}
</div>
{% endblock %}